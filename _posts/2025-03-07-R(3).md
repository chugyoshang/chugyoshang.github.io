---
layout: post
title: R-1
date: 2025-03-07 09:00 +0900
last_modified_at: 2025-03-07 14:00 +0900
categories: [R]
tags: [바이오메디컬, AI, 건양대학교병원, 개발과정, R]
toc: true
---

📌 R 데이터 분석 주요 함수 및 사용법 정리
1. Iris 데이터셋 탐색하기
text
head(iris) # 상위 6개 행 보기
tail(iris) # 하위 6개 행 보기
dim(iris) # 데이터 차원 확인 (행, 열)
length(iris) # 열 개수 확인
NROW(iris) # 행 개수 확인
ncol(iris) # 열 개수 확인
names(iris) # 열 이름 확인
summary(iris) # 통계적 요약 정보 제공
str(iris) # 데이터 구조 확인
class(iris) # 객체 타입 확인
sapply(iris, class) # 각 열의 클래스 타입 확인 (apply 계열 함수)
boxplot(iris) # 이상치(outlier)를 시각적으로 확인
2. 결측치 처리 및 데이터 전처리
시계열 데이터 예시 (forecast 패키지)

text
install.packages("forecast")
library(forecast)

sum(is.na(weather)) # 결측치 개수 확인
weather <- na.omit(weather) # 결측치 제거
BostonHousing 데이터셋 (mlbench 패키지)

text
install.packages("mlbench")
library(mlbench)

data("BostonHousing", package="mlbench")
original <- BostonHousing # 원본 데이터 백업

set.seed(100) # 난수 고정 (재현성 보장)
str(BostonHousing)
sum(is.na(BostonHousing)) # 결측치 확인 및 제거
BostonHousing <- na.omit(BostonHousing)

# 임의로 결측치 생성 후 처리 예시
BostonHousing[sample(1:nrow(BostonHousing),40), "rad"] <- NA

library(mice)
sapply(BostonHousing, function(x) sum(is.na(x))) # 각 열별 결측치 개수 확인

# 회귀 분석 예시 (선형 회귀 모델 생성)
lm(medv ~ ptratio + rad, data=BostonHousing, na.action=na.omit)

# 예측 식 예시:
# medv = -1.8121 * ptratio + (-0.1858 * rad) + 57.8817
결측치 대체(imputation)

text
library(Hmisc)
BostonHousing$rad <- impute(BostonHousing$rad, median)
3. 데이터 범주화 (Binning)
text
x <- -5:5
cut(x, breaks=2)
cut(x, breaks=c(-6,2,5))

# 구간에 이름(label)을 붙이는 방법:
age <- c(0,12,89,14,25,2,65)
cut(age,
    breaks=c(0,19,24,40,65,Inf),
    labels=c("minor","Children","Youth","Adult","Senior"))
4. Cars93 데이터셋 시각화 및 범주화 (ggplot2 패키지)
text
library(MASS)
library(ggplot2)

str(Cars93)
hist(Cars93$MPG.highway)

disc_1 <- Cars93[,c("Model", "MPG.highway")]
disc_1 <- within(disc_1,{
  MPG.highway_cd = character(0)
  MPG.highway_cd[MPG.highway >=20 & MPG.highway <25] = "20~25"
  MPG.highway_cd[MPG.highway >=25 & MPG.highway <30] = "25~30"
  MPG.highway_cd[MPG.highway >=30 & MPG.highway <35] = "30~35"
  MPG.highway_cd[MPG.highway >=35 & MPG.highway <40] = "35~40"
  MPG.highway_cd[MPG.highway >=40 & MPG.highway <45] = "40~45"
  MPG.highway_cd[MPG.highway >=45 & MPG.highway <=50] = "45~50"

  MPG.highway_cd = factor(MPG.highway_cd,
                          levels=c("20~25","25~30","30~35","35~40","40~45","45~50"))
})

table(disc_1$MPG.highway_cd)

# 범주별 평균과 표준편차 계산:
tapply(disc_1$MPG.highway, disc_1$MPG.highway_cd, mean)
tapply(disc_1$MPG.highway, disc_1$MPG.highway_cd, sd)

# 시각화:
ggplot(disc_1,aes(x=MPG.highway_cd,fill=MPG.highway_cd))+geom_bar()
ggplot(disc_1,aes(x=MPG.highway_cd,fill=MPG.highway_cd))+geom_dotplot(binwidth=0.3)
5. 원-핫 인코딩 (One-hot encoding)
text
cust_id <- c("대한", "민국", "만세", "영원", "무궁", "발전", "행복")
age <- c(25,45,31,30,49,53,27)
cust_profile <- data.frame(cust_id, age)

cust_profile <- transform(cust_profile,
                          age_20=ifelse(age>=20&age<30,1,0),
                          age_30=ifelse(age>=30&age<40,1,0),
                          age_40=ifelse(age>=40&age<50,1,0),
                          age_50=ifelse(age>=50&age<60,1,0))
6. 정규화(Normalization)
Min-Max 정규화

text
min_max_norm <- function(x){ (x-min(x))/(max(x)-min(x)) }
iris_norm <- as.data.frame(lapply(iris[1:4],min_max_norm))
Z-점수 정규화

text
z_normal <- function(x){ (x-mean(x))/sd(x) }
iris_z_norm <- as.data.frame(lapply(iris[1:4], z_normal))
7. 이상치 탐지 및 처리
text
boxplot(iris)
re <- boxplot(iris)$out

# 이상치를 NA로 처리 후 중앙값으로 대체:
iris$Sepal.Width[iris$Sepal.Width %in% re] <- NA
library(mice)
iris$Sepal.Width <- impute(iris$Sepal.Width, median)
8. NYC Flights 데이터 처리 예시 (nycflights13 패키지)
text
install.packages("nycflights13")
library(nycflights13)

weather <- nycflights13::weather

upper <- quantile(weather$temp,.75)+1.5*IQR(weather$temp)
lower <- quantile(weather$temp,.25)-1.5*IQR(weather$temp)

weather<-weather[weather$temp<upper&weather$temp>lower,]
9. 샘플 판매데이터 생성 및 분석 예제
state_table (지역정보), month_table (월 정보), prod_table (상품정보)를 생성 후 판매 데이터를 랜덤하게 생성하는 함수(gen_sales)를 정의하여 사용.

tapply()를 이용해 다양한 관점에서 집계 가능.

text
sales_fact<-gen_sales(500)
str(sales_fact)

# 제품별 판매 현황:
tapply(sales_fact$amount,sales_fact[,c("prod")],sum)

# 지역별 판매 현황:
tapply(sales_fact$amount,sales_fact[,c("loc")],sum)

# 특정 조건의 판매액 추출 예시:
subset(sales_fact,
       loc=="SE"&prod=="Printer"&year==2013)$amount %>% sum()